# API Contract: Example Entities

**Feature**: Example Feature  
**Version**: 1.0  
**Base URL**: `/api/v1/entities`

## Endpoints

### 1. Create Entity

**Endpoint**: `POST /api/v1/entities`

**Description**: Create a new example entity

**Authentication**: Required (Bearer token)

**Request Body**:
```json
{
  "name": "string (1-100 chars, required)",
  "status": "active | inactive (required)"
}
```

**Success Response** (201 Created):
```json
{
  "id": "uuid",
  "userId": "uuid",
  "name": "string",
  "status": "active | inactive",
  "createdAt": "ISO8601 timestamp",
  "updatedAt": "ISO8601 timestamp"
}
```

**Error Responses**:
- `400 Bad Request`: Invalid input
  ```json
  {
    "error": "Validation failed",
    "details": [
      { "field": "name", "message": "Name is required" }
    ]
  }
  ```
- `401 Unauthorized`: Missing or invalid token
- `409 Conflict`: Entity with same name already exists

**Example**:
```bash
curl -X POST https://api.example.com/api/v1/entities \
  -H "Authorization: Bearer $TOKEN" \
  -H "Content-Type: application/json" \
  -d '{
    "name": "My Entity",
    "status": "active"
  }'
```

---

### 2. List Entities

**Endpoint**: `GET /api/v1/entities`

**Description**: Get all entities for authenticated user

**Authentication**: Required

**Query Parameters**:
- `status` (optional): Filter by status (`active` | `inactive`)
- `limit` (optional): Max results (default: 50, max: 100)
- `offset` (optional): Pagination offset (default: 0)

**Success Response** (200 OK):
```json
{
  "data": [
    {
      "id": "uuid",
      "name": "string",
      "status": "active | inactive",
      "createdAt": "ISO8601",
      "updatedAt": "ISO8601"
    }
  ],
  "pagination": {
    "total": 123,
    "limit": 50,
    "offset": 0,
    "hasMore": true
  }
}
```

**Example**:
```bash
curl https://api.example.com/api/v1/entities?status=active&limit=10 \
  -H "Authorization: Bearer $TOKEN"
```

---

### 3. Get Entity

**Endpoint**: `GET /api/v1/entities/:id`

**Description**: Get specific entity by ID

**Authentication**: Required

**Path Parameters**:
- `id` (required): Entity UUID

**Success Response** (200 OK):
```json
{
  "id": "uuid",
  "userId": "uuid",
  "name": "string",
  "status": "active | inactive",
  "createdAt": "ISO8601",
  "updatedAt": "ISO8601",
  "items": [
    {
      "id": "uuid",
      "value": 100,
      "createdAt": "ISO8601"
    }
  ]
}
```

**Error Responses**:
- `404 Not Found`: Entity doesn't exist or user doesn't have access

---

### 4. Update Entity

**Endpoint**: `PATCH /api/v1/entities/:id`

**Description**: Update entity fields

**Authentication**: Required

**Request Body** (partial update):
```json
{
  "name": "string (optional)",
  "status": "active | inactive (optional)"
}
```

**Success Response** (200 OK):
```json
{
  "id": "uuid",
  "name": "string",
  "status": "active | inactive",
  "updatedAt": "ISO8601"
}
```

**Error Responses**:
- `400 Bad Request`: Invalid update data
- `404 Not Found`: Entity not found
- `409 Conflict`: Name already exists

---

### 5. Delete Entity

**Endpoint**: `DELETE /api/v1/entities/:id`

**Description**: Delete an entity (must be inactive)

**Authentication**: Required

**Success Response** (204 No Content)

**Error Responses**:
- `400 Bad Request`: Cannot delete active entity
- `404 Not Found`: Entity not found

---

## Data Types

### Entity Status

```typescript
type EntityStatus = 'active' | 'inactive';
```

### Timestamps

All timestamps are in ISO 8601 format:
```
2024-01-15T10:30:00.000Z
```

## Rate Limiting

- **Limit**: 100 requests per minute per user
- **Headers**:
  - `X-RateLimit-Limit`: Total allowed
  - `X-RateLimit-Remaining`: Requests left
  - `X-RateLimit-Reset`: Reset timestamp

**Example**:
```
X-RateLimit-Limit: 100
X-RateLimit-Remaining: 95
X-RateLimit-Reset: 1642248600
```

## Error Format

All errors follow this structure:

```json
{
  "error": "Human-readable message",
  "code": "ERROR_CODE",
  "details": {
    "field": "value"
  }
}
```

## Versioning

API version is in the URL (`/api/v1/...`). Breaking changes will increment version.

---

**Note**: Real contracts are generated by `/ikak:plan` based on functional requirements.
